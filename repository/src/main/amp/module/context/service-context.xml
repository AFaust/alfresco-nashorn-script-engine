<?xml version='1.0' encoding='UTF-8'?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
    <!-- Note: All beans should be prefixed ${project.artifactId} in their ID in general -->
    <!-- Exceptions: service beans (unique name) and beans with name conventions (e.g. web scripts) -->

    <bean id="${project.artifactId}-nashornScriptEngineFactory" class="jdk.nashorn.api.scripting.NashornScriptEngineFactory" />

    <bean id="${project.artifactId}-nashornScriptEngine" factory-bean="${project.artifactId}-nashornScriptEngineFactory" factory-method="getScriptEngine">
        <constructor-arg>
            <list>
                <value>-strict=false</value>
                <value>-scripting=false</value>
                <value>-doe=true</value>
                <value>-pcc=true</value>
                <value>-ot=true</value>

                <value>--debug-lines=true</value>
                <value>--debug-locals=true</value>
            </list>
        </constructor-arg>
    </bean>

    <bean id="${project.artifactId}-nashornJavaScriptProcessor" class="de.axelfaust.alfresco.nashorn.repo.processor.NashornScriptProcessor">
        <property name="engine" ref="${project.artifactId}-nashornScriptEngine" />

        <property name="scriptService" ref="scriptService" />
        <property name="moduleService" ref="ModuleService" />
        <property name="globalProperties" ref="global-properties" />

        <!-- javascript is already taken by javaScriptProcessor -->
        <property name="name" value="nashorn" />
        <!-- js is already taken by javaScriptProcessor -->
        <property name="extension" value="nashornjs" />
    </bean>

    <bean id="baseNashornJavaScriptExtension" abstract="true" init-method="register">
        <property name="processor" ref="${project.artifactId}-nashornJavaScriptProcessor" />
    </bean>
</beans>
